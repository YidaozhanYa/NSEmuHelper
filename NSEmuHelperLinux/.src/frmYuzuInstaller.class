' Gambas class file

Public CurrentStep As Short
Public InstallMode As Short
'1 安装    2 更新模拟器版本   3 更新固件
Public Const StepTemplate As String = "安装 Yuzu - Step "

Public Sub Form_Open()
    Me.Background = Color.white
    Me.Title = "NS 模拟器助手 " & Application.version & " - " & "安装 Yuzu"
    CurrentStep = 1
    Select Case InstallMode
        Case 1
            step1
    End Select
End

Public Sub Step1()
    lblStep.text = StepTemplate & CurrentStep & " 选择模拟器版本"
    Select Case InstallMode
        Case 1
            Lbl1.Text = "在安装模拟器之前，你需要先进行几步选择。\n如果追求最新功能，就使用预先测试版，如果追求稳定，就使用主线版。"
    End Select
    cbBranch.add("预先测试版")
    cbBranch.add("主线版")
    cbBranch.Text = "预先测试版"
    Me.show
    Dim strTmp As String
    Select Case gl.downloadsource
        Case "Aliyundrive"
            strTmp = httpget("https://")
        Case "GitHub"
    End Select
End

Public Sub cbBranch_Change()
    Select Case cbBranch.Text
        Case "预先测试版"
            pic1.Picture = Picture.Load(Application.path & "/Resources/yuzu.png")
        Case "主线版"
            pic1.Picture = Picture.Load(Application.path & "/Resources/yuzu_mainline.jpg")
    End Select
End
